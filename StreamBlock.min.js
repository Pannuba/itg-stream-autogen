class StreamBlock{constructor(s,t,r,e,a){this.measures=s,this.quantization=t,this.nextArrow=r,this.arrows=[],this.lastPattern=null,this.firstMeasure=e,this.lastMeasure=a}addFirstLastMeasure(s,t,r,e=!1){[a,i]=this.convertMeasure(s);var a,i,h,u=!!e,n=!1;for(h=0;h<a.length;h++){if("2222"!=a[h]&&"4444"!=a[h]||n||(u=!0),"3333"==a[h]){t.push(this.arrows[r++]),h++;for(let o=0;o<i-1;o++)t.push("0000"),h++;u=!1,n=!0;break}if(u){t.push(this.arrows[r++]);for(let $=0;$<i-1;$++)t.push("0000"),h++}else t.push(a[h])}for(let f=h;f<a.length;f++)t.push(a[f]);return[t,r]}convertMeasure(s){var t=[],r=s.length,e=this.findLCM(this.quantization,r),a=e/this.quantization,i=e/r;for(let h=0;h<s.length;h++){t.push(s[h]);for(let u=0;u<i-1;u++)t.push("0000")}return[t,a]}findLCM(s,t){for(var r=Math.max(s,t),e=Math.min(s,t),a=r;a%r>0||a%e>0;)a++;return a}isOneMeasure(){for(let s of this.firstMeasure)if("3333"==s)return!0;return!1}addCommas(){var s=[],t=0;if([s,t]=this.addFirstLastMeasure(this.firstMeasure,s,t),!this.isOneMeasure()){s.push(",");for(let r=0;r<this.measures-2;r++){for(let e=0;e<this.quantization;e++)s.push(this.arrows[t++]);s.push(",")}[s,t]=this.addFirstLastMeasure(this.lastMeasure,s,t,!0)}return s}}
