class StreamBlock{constructor(s,t,r,e,i){this.measures=s,this.quantization=t,this.nextArrow=r,this.arrows=[],this.lastPatterns=["X","X"],this.lastDirections=["X","X","X"],this.firstMeasure=e,this.lastMeasure=i}addFirstLastMeasure(s,t,r,e=!1){[i,a]=this.convertMeasure(s);var i,a,h,u=!!e,$=!1;for(h=0;h<i.length;h++){if("2222"!=i[h]&&"4444"!=i[h]||$||(u=!0),"3333"==i[h]&&!$){t.push(this.arrows[r++]),h++;for(let n=0;n<a-1;n++){if("2222"==i[h]||"4444"==i[h]&&h<i.length){u=!1,$=!0;break}h<i.length&&(t.push("0000"),h++)}u=!1,$=!0}if(u){t.push(this.arrows[r++]);for(let o=0;o<a-1;o++){if("3333"==i[h]){t.push("0000"),h++,u=!1,$=!0;break}if(t.push("0000"),"3333"==i[++h]){h++,u=!1,$=!0;break}}}h<i.length&&!u&&t.push(i[h])}return[t,r]}convertMeasure(s){var t=[],r=s.length,e=this.findLCM(this.quantization,r),i=e/this.quantization,a=e/r;for(let h=0;h<s.length;h++){t.push(s[h]);for(let u=0;u<a-1;u++)t.push("0000")}return[t,i]}findLCM(s,t){for(var r=Math.max(s,t),e=Math.min(s,t),i=r;i%r>0||i%e>0;)i++;return i}isOneMeasure(){for(let s of this.firstMeasure)if("3333"==s)return!0;return!1}addCommas(){var s=[],t=0;if([s,t]=this.addFirstLastMeasure(this.firstMeasure,s,t),!this.isOneMeasure()){s.push(",");for(let r=0;r<this.measures-2;r++){for(let e=0;e<this.quantization;e++)s.push(this.arrows[t++]);s.push(",")}[s,t]=this.addFirstLastMeasure(this.lastMeasure,s,t,!0)}return s}}